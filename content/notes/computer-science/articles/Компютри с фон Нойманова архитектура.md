---
title: Компютри с фон Нойманова архитектура
tags:
- computer-science
---

> Информацията е взета от лекции по "Основи на информатиката" в НБУ водени от доц. д-р Петя Асенова.

## Компютърна архитектура

Под архитектура на компютърна система се разбира начина, по който са свързани и взаимодействат отделните части на компютъра. Обикновено архитектурата на компютърната система се представя чрез блокова схема. От системна гледна точка, компютърът е система, която получава входна информация (**данни**), обработва информацията и показва получените резултати. От функционална гледна точка, компютърът е изграден от следните функционални компоненти: 
1. **Данни**: това, което се обработва 
2. **Хардуер**: компоненти, които реализират технологиите използвани в компютъра
3. **Софтуер**: множество от компютърни програми, осъществяващи обработката на информацията
4. **Периферия**: обикновено външни устройства, подключени към основния компютърен компонент за въвеждане/извеждане на информацията
5. **Потребителски интерфейс**: хардуерни или софтуерни средства за връзка с потребителя
6. **Комуникация**: хардуерни или софтуерни средства за връзка с други компютри/устройства/системи

## Компютри с фон Нойманова архитектура 

> *по избор:* През **1945-1946г.** Джон фон Нойман въз основа на натрупания опит е стигнал до извода за целесъобразността от **двоичното представяне на числата и данните и за съхраняването им в една памет**. Тези негови възгледи са заложени в първия действащ компютър **UNIVAC**, в който на практика е реализиран компютъра на **Джон Атанасов**.

- Използването на два знака (`0` или `1`) опростява електронните схеми в процеса, което ги прави по-надеждни и по-малко грешат
- За физическата реализация на `0` и `1` се използват различни състояния:
	- високо / ниско напрежение
	- включен / изключен светлинен поток
	- незареден / зареден кондензатор

### Принципи на фон Нойман
- **Първи принцип:** 
	- компютърът е електронно устройство;
	- всичко в него се извършва от електронни схеми.
- **Втори принцип:** 
	- информацията в компютъра се представя в двоична бройна система; 
	- всички операции се изпълняват от електронни схеми над операнди, представени в двоичен код;
	- електронните схеми работят на основата на булевата алгебра.
- **Трети принцип:**
	- компютърът е програмно управляемо устройство;
	- програмите и данните се съхраняват в памет
	
### Схема

![von Neumann diagram](/notes/assets/von-neumann-diagram.png#invert_B)


### Основни компоненти

#### Процесор
Процесорът управлява цялостната работа на компютъра. Изпълнява набор от инструкции, изпълнявайки по този начин някакъв алгоритъм.

Електронните схеми се сглобяват от примитивни електронни елементи, реализиращи булевите функции конюнкция, дизюнкция и отрицание.

**Компоненти на процесора**:
- **Аритметико-логическо устройство (АЛУ)**: изграден от логически схеми. Извършва аритметични и логически операции.
- **Управляващо устройство (УУ)**: този блок управлява всички функции на CPU: какви операции трябва да бъдат извършени, кога трябва да бъдат извършени и кои компоненти на CPU участват в тези операции.
- **Магистрали** - проводници, по които се предават данни, адреси и управляващи и синхронизиращи сигнали от едно устройство към друго. Процесорът има вътрешни магистрали, които използва за предаване на данни, инстуркции, конфигурации и състояния между неговите компоненти. Съществуват и магистрали за обслужване на външни устройства, които представляват линии за прекъсване и взимане на състояние на устройствата.
- **Регистри**: малки и бързи памети. Променливите и указателите се "местят" от оперативната памет в регистрите, когато се използват от процесора. Това ускорява обработката. Типове регистри: 
	- **регистри за данни** - помнят данните,
	- **адресни регистри** - помнят адреси (за чете или писане),
	- **регистри за инструкции** - помнят текущата инструкция, 
	- **брояч на инструкциите** - помни адреса на следващата инструкция
	- **регистри за флагове** - групирани отделни битове, които представят състоянието на дадена операция или на процесора
	- **конфигурационни регистри**: някои от функциите на процесора могат да бъдат конфигурирани. Конфигурационните регистри съдържат текущата конфигурация на процесора. Те също могат да съдържат информация за адресирането, например, коя част от паметта е защитена и коя не.
- **Флагове**: индикатори, които показват състоянието на системата. Всеки флаг е представен с един бит.
- **Буфери**: тип памет, която съхранява резултата от работата на процесори различни от главния процесор (напр. видеопроцесори, процесори за входно-изходни устройства, т.н.). Когато някой процесор се нуждае от резултата на друг процесор, той го изтегля от буфера.
- **Стек**: временна памет. Процесорът извършва със стека две операции: 
	- да запомни стойност на регистър на върха на стека;
	- да отстрани данните от върха на стека и да ги запомни в регистър.
- **Входно-изходни портове**: осъществяват връзки между процесора и външните устройства.
- **Централен процесорен блок (CPU)**:  извършва изпълнението на всички инструкции, както и необходимите изчисления за определяне на различните адреси
- **Вътрешна памет**: малка, много бърза памет, предназначена за вътрешни (бързи) изчисления, без обръщения към оперативната памет
- **Буфер за данни**: двупосочно устройство, което съхранява изходящите данни (докато магистралата на паметта стане готова да ги приеме) и входящите данни (докато CPU стане готов за тях)
- **Адресни тригери**: група от тригери, управляващи адресите от паметта, с които процесорът желае да обменя данни
- **Декодер на инструкциите**: всички инструкции се помнят в двоични стойности. Декодерът получава инструкцията от паметта, интерпретира стойността, за да определи какво да се извърши, и указва на **АЛУ** и **регистрите** кои електронни схеми да се активират, за да се изпълни инструкцията.

**Как работи процесорът:**
1. **УУ** извлича от **ОП (оперативна памет)** инструкциите, чийто адрес е в **брояч на инструкциите**.
2. След това инструкцията се анализира, като се определят какво да се изпълни и кои са адресите, в които се съхраняват данните, необходими за изпълнение на инструкцията 
3. Данните се извличат от адресите. 
4. За изпълнение на инструкцията се стартира съответната логическа схема. 
5. След изпълнение на инструкцията се определя ново съдържание на **брояч на инструкциите**

Всеки процесор изпълнява набор от инструкции. Инструкциите се декодират в двоични числа, наречени машинен код. Процесорът може да изпълнява единствено машинен код на неговия машинен език. Това е езикът на най-ниско ниво, езикът на схемите.

За да се окажат два сигнала на входа на един елемент в едно и също време, е необходимо да се синхронизира тяхното движение. Това се постига, като процесите на изчисление се извършват на тактове.

Ритъмът / тактовете за работа на процесора се задават от устройство, наречено **тактов генератор**. Колкото по-висока е честотата на тактовия генератор, толкова по-бързо ще работи компютърът.

### Памет

Паметта е изградена от електронни компоненти, наречени **тригери**, организирани във вид на **матрица**.

**Тригерът** е проста електронна схема, която има на изхода си само две стабилни състояния, условно обозначени като `0` и `1`.

**Матрицата** от клетки памет е организирана така, че *всеки ред представлява множество битове*, които се намират на един адрес и в които могат да се записват инструкциите или данни. *Колоните представляват различните битове* в това множество. Паметта изглежда като матрица, където броят на редовете определя броят различни адреси от паметта, а броят на колоните определя броят битове на всеки адрес.

![von Neumann memory](/notes/assets/von-neumann-memory.png#invert_B)

За да запише или извлече данни от паметта, процесорът трябва да подаде двоичния код на адреса на специални **шини**, наречени адресни (address lines). 

Клетките от сътоветния адрес се свързват с двупосочни шини за данни (data lines), които позволяват да се прочете информацията от тези клетки.

Обменът на данни между процесора и паметта се контролира чрез линии за три допълнителни сигнала: 
- chip select (избор на схема) 
- read enable (разрешено четене) 
- write enable (разрешен запис).

Адресният декодер (address decoder) е електронна схема с $n$ входа и $2^n$ изхода, при която само един изход ще остане активен, ако се появи комбинация от нули и единици на неговите входове. Така адресният декодер избира точно **един ред** от матрицата, в който пишем или от който четем.

> Пример, ако на адресните шини се появи числото $011_2 = 3_{10}$, се избира третия ред от паметта и той се свързва с шината за данни.

Процесорът използва входовете **read enable** и **write enable**, за да определи дали ще четем или ще записваме в избраният ред от матрицата на паметта. Тези сигнали са ниско активни[^1]. read enable и write enable никога не могат да бъдат активни едновременно.

Входът **chip select** разрешава или забранява схемата на паметта. Причината е, че процесорът работи с много памети и в даден момент трябва да комуникира само с една. Ако **chip select**  е `0` => паметта е активна и всички нейни входни и изходни сигнали се използват за предаване на данни.

За да няма колизия и при използване на шината за данни от различни устройства, се използва **chip select**. Всяко устройство памет има свой собствен вход **chip select**, и не е възможно по едно и също време два сигнала chip select, на две различни устройства, да са нули.

##### Типове памет
**Оперативна**:
- **RAM**: 
	- съхранява данните и програмите, които се използват в момента
	- контролира се от ОС
	- бърза при четене и запис
	- при изключване се губят записаните данни
	- има два вида: 
		- **SRAM** (static RAM) - по-бърза, но скъпа
		- **DRAM** (dynamic RAM)
- **ROM**:
	- памет само за четене
	- фабрично записана
	- не се чисти при изключване
	- процесорът може да се записва в нея само със специални допълнителни механизми
- **Cache**: 
	- междинна памет, в която процесора чете преди да се обърне към **RAM**
	- за кеш се използва **SRAM**
	- може да бъде разделена на две: кеш памет за инструкции и кеш памет за данни
- **Регистър**: 
	- малка бърза памет за специфични функции: да запомни цяло число, адрес от паметта, да конфигурира входно/изходно устройство или да покаже състоянието на процеса.

#### Шини

**Адресните шини** се контролират изцяло от процесора и се използват за да се определи с кой ред от матрицата на паметта процесорът желае да комуникира. Понеже този единствен ред може да се намира в различни схеми памет, адресните шини се използват и за определяне на коя схема памет е разрешена.

По **управляващите шини** текат сигнали, използвани за управление на процеса на предаване на данни - кога се предават данните, в коя посока и др. Процесорът контролира управляващите шини.

#### Периферни устройства

Компонент от фон Нойманова архитектура. Може да бъдат принтери, скенери, клавиатура, мишка и др.

[^1]: **ниско активни**: активно е, когато стойността е `0`

--------

## Разработени въпроси

### Понятие за архитектура на компютъра

>  Комбинация от хардуерни компоненти и техните множества от инструкции.

### Основни компоненти в компютри с фон Нойманова архитектура

> - **Процесор**: Всеки процесор изпълнява набор от инструкции, интрукциите се декодират в двоични числа - машинен код. Състои се от управляващо устройство, аритметико-логическо устройство, магистрали, регистри, вътрешна памет
> - **Памет**: Паметта е изградена от електронни компоненти, наречени **тригери**, организирани във вид на **матрица**. Има различни типове памет: RAM, ROM, Cache, Регистър
> - **Шини**: Управлявани от процесора и се използват за определян с кой ред от матрицата на паметта процесора желае да комуникира - **адресни шини** или за управление на процеса на предаване на данни (напр. посока) - **управляващи шини**.
> - **Периферни устройства**: Допълнителен хардуер за подаване на информация на компютъра (мишка, клавиатура, камера) или получаване на информация от компютъра (монитор, слушалки).

### Оперативна памет на компютър от Фон Нойманов тип

> Паметта изглежда като матрица, където броят на редовете определя броят различни адреси от паметта, а броят на колоните определя броят битове на всеки адрес. Шини използвани от паметта:
> - **адресни шини** - за указване къде в паметта ще пише/чете процесора
> - **шини за данни** - двупосочни, които позвоялват да се чете/запише данни в указан адрес

### Сигнали за управление на матричната памет

> Три линии за **chip select (избор на схема)**, **read enable (четене)**, **write enable (писане)**. Процесорът използва входовете **read enable** и **write enable**, за да определи дали ще четем или ще записваме в избраният ред от матрицата на паметта. За да няма колизия и при използване на шината за данни от различни устройства, се използва **chip select**. Всяко устройство памет има свой собствен вход **chip select**, и не е възможно по едно и също време два сигнала chip select, на две различни устройства, да са *нули* (те са ниско активни). 

### RAM и ROM – кратка характеристика

>  **RAM:** бърза при четене и запис памет, при изключване се губят данните. Програмите и данните използвани от тях се зареждат в нея от ОС.
>  **ROM:** фабрично записана памет само за четене (процесора може да записва в нея само със специални механизми). Не се чисти при изключване.

### Кеш памет от първо и второ ниво

> 	Кеш паметта (направена от SRAM вид RAM) e междинна бърза памет използвана от процесора преди да се обърне към RAM паметта, ако дадена информация не бъде намерена. За разлика от оперативната памет, в която достъп до определена информация се постига чрез адресиране, в кеш паметта се използват методи за претърсване. При поставяне на по-малък блок от SRAM между кеш паметта и процесора се създават **две нива на кеш** памет. Тази нова памет обикновено се поставя вътре в самия процесор и се нарича памет от **първо ниво**. Кеш паметта между процесора и оперативната памет  се нарича кеш памет от **второ ниво**.

### Аритметико-логическо устройство

> Функцията на **АЛУ** е математическата и логическата обработка на данни. АЛУ извършва:
> - аритметични операции с цели числа (събиране, изваждане, умножение, деление),
> - побитови логически операции (логическо „И“, логическо „ИЛИ“, логическо „НЕ“),
> - побитови манипулации (разместване). 
> 
> Входните данни на **АЛУ** са операнди и код на операцията, която да бъде изпълнена.

### Управляващо устройство

> Tози блок в процесора управлява всички функции на CPU: 
> - какви операции трябва да бъдат извършени, 
> - кога трябва да бъдат извършени и 
> - кои компоненти на CPU участват в тези операции. 

### Буфериране

> При буферирането данните от резултата на операцията на един процесор (напр. видеопроцесор), различен от главния, се съхраняват в буфери (тип памет) и когато някой друг процесор (напр. процесор за входно-изходни устройства) се нуждае от резултата, то той се изтегля от буфери.

### Регистър _Брояч на инструкциите_ 

> Брояч на инструкциите е тип регистър (малка и бърза памет в оперативната памет), която помни адреса на следващата инструкция към процесора. Управляващото устройство извлича инструкциите от оперативната памет използвайки адреса на следващата инструкция. 